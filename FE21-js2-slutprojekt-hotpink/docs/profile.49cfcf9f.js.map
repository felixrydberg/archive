{"mappings":"oeAAA,IAAAA,EAAAC,EAAA,sBAIC,MAEC,GAAIC,eAAeC,QAAQ,SAAU,CACnBC,WAEd,MAAMC,EAC+B,OAAnCH,eAAeC,QAAQ,QACnBD,eAAeC,QAAQ,QACvBD,eAAeC,QAAQ,iBAEvBH,EAAAM,IAAIN,EAAAO,IAAIC,EAAAC,GAAI,UAAUJ,EAASK,kBAAkBC,MACpDC,IACC,IAAIC,EAAYC,SAASC,eAAe,YACpCC,EAAYF,SAASC,eAAe,OACxC,GAAIH,EAASK,SAAU,CACrB,MAnBZC,IAmBoBA,EAnBpBC,IAmByBA,EAnBzBC,SAmB8BA,GAAaR,EAASS,MAWxC,GAREP,SAASC,eAAe,cAEXO,IAAMH,EACrBN,EAAUU,UAAYH,EACtBJ,EAAUO,UAAYL,EAIlBhB,eAAeC,QAAQ,UAAYE,EAAU,CAE7CS,SAASU,cAAc,mBACXC,iBAAiB,SAAUC,IACvCA,EAAEC,iBACF,MAAMC,EAAQ5B,EAAAO,IAAIC,EAAAC,GAAI,UAAUJ,KAChCL,EAAA6B,OAAOD,GACP1B,eAAe4B,QACfC,OAAOC,SAASC,QAAQ,yBAI5BpB,EAAUU,UAAY,eACtBP,EAAUO,UACR,kFAKVW,QAEAH,OAAOC,SAASC,QAAQ,MCnDb,WACb,GAAI/B,eAAeC,QAAQ,SAAU,CAEnCW,SACGC,eAAe,WACfU,iBAAiB,SAAUC,IAC1BA,EAAEC,iBACFzB,eAAeiC,QACb,UACAjC,eAAeC,QAAQ,QAAQO,eAEjCqB,OAAOC,SAASC,QAAQ,qBAGOnB,SAASU,cAAc,cAChDY,MAAMC,QAAU,OAGSvB,SAASU,cAAc,cAChDY,MAAMC,QAAU,OAGUvB,SAASU,cAAc,YAChDY,MAAMC,QAAU,QAG3B,IAAIC,EAA+BxB,SAASU,cAAc,cAC1Dc,EAAUF,MAAMC,QAAU,QAC1BC,EAAUb,iBAAiB,SAAS,KAClCvB,eAAe4B,QACfE,SAASO,aDwBbC,IAlDD","sources":["src/script/profile.ts","src/script/modules/navtoggle.ts"],"sourcesContent":["import { DataSnapshot, get, ref, remove } from 'firebase/database';\r\nimport { db } from './modules/db';\r\nimport navToggle from './modules/navtoggle';\r\n\r\n((): void => {\r\n  // If user is logged in\r\n  if (sessionStorage.getItem('login')) {\r\n    const getUser = async (): Promise<void> => {\r\n      // catch correct username to display\r\n      const userName =\r\n        sessionStorage.getItem('name') === null\r\n          ? sessionStorage.getItem('name')\r\n          : sessionStorage.getItem('profile');\r\n\r\n      await get(ref(db, `/users/${userName.toLowerCase()}`)).then(\r\n        (snapshot: DataSnapshot): void => {\r\n          let firstName = document.getElementById('username');\r\n          let biography = document.getElementById('bio');\r\n          if (snapshot.exists()) {\r\n            const { bio, img, username } = snapshot.val();\r\n\r\n            let profilePicture = <HTMLImageElement>(\r\n              document.getElementById('profilepic')\r\n            );\r\n            profilePicture.src = img;\r\n            firstName.innerText = username;\r\n            biography.innerText = bio;\r\n\r\n            // If user is owner of profile, add listener that allows user to delete account\r\n            // clear sessionstorage and sends user to startpage\r\n            if (sessionStorage.getItem('name') === userName) {\r\n              const removeAccount: HTMLButtonElement =\r\n                document.querySelector('.remove-profile');\r\n              removeAccount.addEventListener('click', (e: MouseEvent): void => {\r\n                e.preventDefault();\r\n                const dbRef = ref(db, `/users/${userName}`);\r\n                remove(dbRef);\r\n                sessionStorage.clear();\r\n                window.location.replace('./index.html');\r\n              });\r\n            }\r\n          } else {\r\n            firstName.innerText = 'No such user';\r\n            biography.innerText =\r\n              'If this user ever existed will remain one of lifes great unsolved mysteries';\r\n          }\r\n        }\r\n      );\r\n    };\r\n    getUser();\r\n  } else {\r\n    window.location.replace('/');\r\n  }\r\n\r\n  navToggle();\r\n})();\r\n","export default function navToggle(): void {\r\n  if (sessionStorage.getItem('login')) {\r\n    // Added clickelement on profile button, which captures login username into profile storage and reroutes to profile\r\n    document\r\n      .getElementById('profile')\r\n      .addEventListener('click', (e: MouseEvent): void => {\r\n        e.preventDefault();\r\n        sessionStorage.setItem(\r\n          'profile',\r\n          sessionStorage.getItem('name').toLowerCase()\r\n        );\r\n        window.location.replace('./profile.html');\r\n      });\r\n\r\n    let btnsignIn: HTMLAnchorElement = document.querySelector('#signinbtn');\r\n    btnsignIn.style.display = 'none';\r\n\r\n    // Slutar visa signup om man 채r inloggad\r\n    let btnsignUp: HTMLAnchorElement = document.querySelector('#signupbtn');\r\n    btnsignUp.style.display = 'none';\r\n\r\n    // Om man 채r inloggad visas denna knapp.\r\n    let profilebtn: HTMLAnchorElement = document.querySelector('#profile');\r\n    profilebtn.style.display = 'block';\r\n\r\n    // Om man 채r inloggad visas denna knapp. Om man trycker p책 den tas variabler i SessionStorage bort och sidan laddas om\r\n    let btnlogout: HTMLAnchorElement = document.querySelector('#logoutbtn');\r\n    btnlogout.style.display = 'block';\r\n    btnlogout.addEventListener('click', () => {\r\n      sessionStorage.clear();\r\n      location.reload();\r\n    });\r\n  }\r\n}\r\n"],"names":["$8tedJ","parcelRequire","sessionStorage","getItem","async","userName","get","ref","$fC0jS","db","toLowerCase","then","snapshot","firstName","document","getElementById","biography","exists","bio","img","username","val","src","innerText","querySelector","addEventListener","e","preventDefault","dbRef","remove","clear","window","location","replace","getUser","setItem","style","display","btnlogout","reload","$b0cfc8d9550b1f45$export$2e2bcd8739ae039"],"version":3,"file":"profile.49cfcf9f.js.map"}